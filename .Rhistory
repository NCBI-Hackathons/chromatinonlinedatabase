a[c(b[[2]][1],b[[2]][2])]
## CAA25015.2 ******** myc oncogene
myc <- c("MPLNVSFTNRNYDLDYDSVQPYFYCDEEENFYQQQQQSELQPPAPSEDIWKKFELLPTPPLSPSRRSGLC
SPSYVAVTPFSLRGDNDGGGGSFSTADQLEMVTELLGGDMVNQSFICDPDDETFIKNIIIQDCMWSGFSA
AAKLVSEKLASYQAARKDSGSPNPARGHSVCSTSSLYLQDLSAAASECIDPSVVFPYPLNDSSSPKSCAS
QDSSAFSPSSDSLLSSTESSPQGSPEPLVLHEETPPTTSSDSEEEQEDEEEIDVVSVEKRQAPGKRSESG
SPSAGGHSKPPHSPLVLKRCHVSTHQHNYAAPPSTRKDYPAAKRVKLDSVRVLRQISNNRKCTSPRSSDT
EENVKRRTHNVLERQRRNELKRSFFALRDQIPELENNEKAPKVVILKKATAYILSVQAEEQKLISEEDLL
RKRREQLKHKLEQLRNSCA")
richard <- fSiteFinder(peptide_vector = myc)
dusp6 <- c("MIDTLRPVPFASEMAISKTVAWLNEQLELGNERLLLMDCRPQELYESSHIESAINVAIPGIMLRRLQKGN
LPVRALFTRGEDRDRFTRRCGTDTVVLYDESSSDWNENTGGESLLGLLLKKLKDEGCRAFYLEGGFSKFQ
AEFSLHCETNLDGSCSSSSPPLPVLGLGGLRISSDSSSDIESDLDRDPNSATDSDGSPLSNSQPSFPVEI
LPFLYLGCAKDSTNLDVLEEFGIKYILNVTPNLPNLFENAGEFKYKQIPISDHWSQNLSQFFPEAISFID
EARGKNCGVLVHCLAGISRSVTVTVAYLMQKLNLSMNDAYDIVKMKKSNISPNFNFMGQLLDFERTLGLS
SPCDNRVPAQQLYFTTPSNQNVYQVDSLQST")
dusp6.1 <- fSiteFinder(peptide_vector = dusp6)
View(dusp6.1)
mapk3 <- c("MAAAAAAPGGGGGEPRGTAGVVPVVPGEVEVVKGQPFDVGPRYTQLQYIGEGAYGMVSSAYDHVRKTRVA
IKKISPFEHQTYCQRTLREIQILLGFRHENVIGIRDILRAPTLEAMRDVYIVQDLMETDLYKLLKSQQLS
NDHICYFLYQILRGLKYIHSANVLHRDLKPSNLLINTTCDLKICDFGLARIADPEHDHTGFLTEYVATRW
YRAPEIMLNSKGYTKSIDIWSVGCILAEMLSNRPIFPGKHYLDQLNHILGILGSPSQEDLNCIINMKARN
YLQSLPSKTKVAWAKLFPKSDSKALDLLDRMLTFNPNKRITVEEALAHPYLEQYYDPTDEPVAEEPFTFD
MELDDLPKERLKELIFQETARFQPGAPEAP")
mapk3.1 <- fSiteFinder(peptide_vector = mapk3)
View(mapk3.1)
fSiteFinder <- function(peptide_vector, residue = "F"){
b <- str_split(peptide_vector, pattern = "")
c <- unlist(b)
peptide <- c[!(c %in% c("\n"," "))]
aminoacid <- c()
for(i in 1:length(peptide)){
if(peptide[i] == residue){
aminoacid <- c(aminoacid, i)
} else {
next
}
}
index <- 1
final_list <- list()
for(i in 1:length(aminoacid)){
site = aminoacid[i] + 2
if(peptide[site] == residue){
final_list[[index]] <- c(site - 2, site)
index = index + 1
} else {
next
}
}
return(final_list)
}
mapk3.1 <- fSiteFinder(peptide_vector = mapk3, residue = "L")
View(mapk3.1)
mapk3.2 <- fSiteFinder(peptide_vector = mapk3, residue = "F")
View(mapk3.2)
View(mapk3.1)
mapk3[347,349]
mapk3[c(347,349)]
where("final_list")
dusp6.1 <- fSiteFinder(peptide_vector = dusp6)
View(dusp6.1)
fSiteFinder <- function(peptide_vector, residue = "F"){
b <- str_split(peptide_vector, pattern = "")
c <- unlist(b)
peptide <- c[!(c %in% c("\n"," "))]
aminoacid <- c()
for(i in 1:length(peptide)){
if(peptide[i] == residue){
aminoacid <- c(aminoacid, i)
} else {
next
}
}
index <- 1
final_list <- list()
for(i in 1:length(aminoacid)){
site = aminoacid[i] + 2
if(peptide[site] == residue){
final_list[[index]] <- c(site - 2, site)
index = index + 1
} else {
next
}
}
#return(final_list)
return(peptide)
}
dusp6.0 <- fSiteFinder(peptide_vector = dusp6)
fSiteFinder <- function(peptide_vector, residue = "F"){
b <- str_split(peptide_vector, pattern = "")
c <- unlist(b)
peptide <- c[!(c %in% c("\n"," "))]
aminoacid <- c()
for(i in 1:length(peptide)){
if(peptide[i] == residue){
aminoacid <- c(aminoacid, i)
} else {
next
}
}
index <- 1
final_list <- list()
for(i in 1:length(aminoacid)){
site = aminoacid[i] + 2
if(peptide[site] == residue){
final_list[[index]] <- c(site - 2, site)
index = index + 1
} else {
next
}
}
return(final_list)
#return(peptide)
}
dusp6.1 <- fSiteFinder(peptide_vector = dusp6)
View(dusp6.1)
View(dusp6.1)
dusp6.0[c(334,336)]
dusp6.1 <- fSiteFinder(peptide_vector = dusp6, residue = "L")
View(dusp6.1)
View(dusp6.1)
str(dusp6.1[[3]])
str(as.vector(dusp6.1[[3]]))
is.vector(dusp6.1[[3]])
?%>%
%>%
?>
setwd("C:/Users/Nate Diehl/OneDrive - University of North Carolina at Chapel Hill/RPPA/")
library(gplots)
source(file = "C:/Users/Nate Diehl/OneDrive - University of North Carolina at Chapel Hill/R Common Scripts/rppa_functions.R")
kg <- as.data.frame(read.csv(file = "C:/Users/Nate Diehl/Dropbox/KirstenRPPA/raw_data/cleaned_raw.csv", row.names = 1))
kg24 <- kg[grep(pattern = "24Hour", rownames(kg)),]
tr.all <- c(".24Hour.")
treated.rows <- unlist(lapply(tr.all, grep, x = rownames(kg24), fixed = T))
treatment.status <- c()
for(i in 1:nrow(kg24)){
if(any(treated.rows == i)){
treatment.status[i] <- 1
} else {
treatment.status[i] <- 0
}
}
kgt <- cbind(kg24, treatment.status)
kgt_replace <- kgt
for(i in 1:nrow(kgt)){
for(j in 1:ncol(kgt)){
colmean <- median(kgt[,j], na.rm = TRUE)
if(is.na(kgt[i,j])){
kgt_replace[i,j] <- colmean
}else{
kgt_replace[i,j] <- kgt[i,j]
}
}
}
kgt_spear <- cor(kgt_replace, method = "spearman")
colorpal <- colorpanel(21, low = "#2E77EC", mid = "#E6E6E6", high = "#FF471A")
## medium size heatmap
kgt_vectsam1 <- kgt_replace[,vectsam1]
kgt_vectsam1_spear <- cor(kgt_vectsam1, method = "spearman")
vectsam <- c("mTOR.S2448", "X4EBP1.S65", "p70S6.Kinase.T389", "p70S6.Kinase.T412", "S6.Ribosomal.Protein.S240.244", "S6.Ribosomal.Protein.S235.236",
"eIF4G.S1108", "AMPKalpha.T172", "Atg5")
vectsam1 <- c("mTOR.S2448", "X4EBP1.S65", "p70S6.Kinase.T389", "p70S6.Kinase.T412", "S6.Ribosomal.Protein.S240.244", "S6.Ribosomal.Protein.S235.236",
"eIF4G.S1108", "AMPKalpha.T172", "Atg5", "c.Myc", "ERK.1.2.T202.Y204", "RSK3.T356.360", "p90RSK.S380")
vectsam2 <- c("mTOR.S2448", "X4EBP1.S65", "p70S6.Kinase.T389", "p70S6.Kinase.T412", "S6.Ribosomal.Protein.S240.244", "S6.Ribosomal.Protein.S235.236",
"eIF4G.S1108", "AMPKalpha.T172", "Atg5", "c.Myc", "ERK.1.2.T202.Y204", "RSK3.T356.360", "p90RSK.S380", "Heme.Oxygenase.1",
"Mn.Superoxide.Dismutase", "Cu.Zn.Superoxide.Dismutase", "Acetyl.CoA.Carboxylase.S79", "cPLA2.S505", "BLVRB..Biliverdin.Reductase.B.",
"Thioredoxin.Reductase.1", "Cytochrome.C.oxidoreductase")
df1 <- data.frame(vectsam, vectsam1, vectsam2)
colorpal <- colorpanel(21, low = "#2E77EC", mid = "#E6E6E6", high = "#FF471A")
## medium size heatmap
kgt_vectsam1 <- kgt_replace[,vectsam1]
kgt_vectsam1_spear <- cor(kgt_vectsam1, method = "spearman")
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, mar = c(10,10), cexRow = 1.2, cexCol = 1.2, main = "new")
dev.off()
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
par(mai=c(1.10,0.82,0.82,0.6))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, mar = c(10,10), cexRow = 1.2, cexCol = 1.2, main = "new")
dev.off()
#par(mai=c(1.02,0.82,0.82,0.42))
par(mai=c(1.7,0.82,0.82,1.2))
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, mar = c(10,10), cexRow = 1.2, cexCol = 1.2, main = "new")
dev.off()
?heatmap.2
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, mar = c(10,10), cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(7,7))
dev.off()
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, mar = c(10,10), cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14))
dev.off()
x <- kgt_vectsam2
x <- kgt_vectsam1
?grep
namex <- c("S6.Ribosomal.Protein.S240.244", "S6.Ribosomal.Protein.S235.236")
namenew <- c("S6.Ribo.Protein.S240.244", "S6.Ribo.Protein.S235.236")
x <- vectsam1
x <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", rownames(x), fixed = TRUE)
x <- rownames(kgt_vectsam1)
y <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", rownames(x), fixed = TRUE)
x <- rownames(kgt_vectsam1)
y <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", x = x, fixed = TRUE)
## medium size heatmap
kgt_vectsam1 <- kgt_replace[,vectsam1]
rownames(kgt_vectsam1) <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", x = rownames(vectsam1), fixed = TRUE)
## medium size heatmap
kgt_vectsam1 <- kgt_replace[,vectsam1]
rownames(kgt_vectsam1) <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", x = rownames(kgt_vectsam1), fixed = TRUE)
rownames(kgt_vectsam1)
colnames(kgt_vectsam1) <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", x = colnames(kgt_vectsam1), fixed = TRUE)
colnames(kgt_vectsam1)
colnames(kgt_vectsam1) <- sub(pattern = "S6.Ribosomal.Protein.S235.236", replacement = "S6.Ribo.Protein.S235.236", x = colnames(kgt_vectsam1), fixed = TRUE)
kgt_vectsam1_spear <- cor(kgt_vectsam1, method = "spearman")
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14))
dev.off()
#calculates spearman correlations of all possible variable pairings
install.packages("hmisc")
#calculates spearman correlations of all possible variable pairings
install.packages("Hmisc")
library(Hmisc)
z<-rcorr(as.matrix(kgt_vectsam1),type=c("spearman"))
View(z)
#flattens the matrix and gives you a nice table of all results
z1<-flattenCorrMatrix(zf$r, z$P)
#flattens the matrix and gives you a nice table of all results
z1<-z$P
View(z1)
replot <- z$r
jpeg("ERKi_correlation_matrix_medvect1_replot.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(replot, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14))
dev.off()
kgt_vectsam1_spear <- z$r
## Isolates the p-value matrix
kgt_vectsam1_pval <-z$P
bb <- signif(kgt_vectsam1_pval, digits = 3)
jpeg("ERKi_correlation_matrix_medvect1.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.7, notecol = "black")
dev.off()
print("***")
print(c("***","**","*", "****")
)
bb <- pp
?matrix
pp <- matrix(rep(NA, times = 13*13), nrow = 13, ncol = 13)
for(i in 1:nrow(bb)){
for(j in 1:nrow(bb)){
if(bb[i,j] < 0.0005){
pp[i,j] <- c("***")
next
}else if(bb[i,j] < 0.005){
pp[i,j] <- c("**")
next
}else if(bb[i,j] < 0.05){
pp[i,j] <- c("*")
next
}else{
next
}
}
}
for(i in 1:nrow(bb)){
for(j in 1:nrow(bb)){
if(is.na(bb[i,j])){
next
}else if(bb[i,j] < 0.0005){
pp[i,j] <- c("***")
next
}else if(bb[i,j] < 0.005){
pp[i,j] <- c("**")
next
}else if(bb[i,j] < 0.05){
pp[i,j] <- c("*")
next
}else{
next
}
}
}
View(pp)
jpeg("ERKi_correlation_matrix_medvect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.7, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_medvect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = p, notecex = 1, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_medvect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = pp, notecex = 1, notecol = "black")
dev.off()
starcalc <- function(input.dat){
new.dat <- matrix(rep(NA, times = ncol(input.dat)*nrow(input.dat)))
for(i in 1:nrow(input.dat)){
for(j in 1:nrow(input.dat)){
if(is.na(input.dat[i,j])){
next
}else if(input.dat[i,j] < 0.0005){
new.dat[i,j] <- c("***")
next
}else if(input.dat[i,j] < 0.005){
new.dat[i,j] <- c("**")
next
}else if(input.dat[i,j] < 0.05){
new.dat[i,j] <- c("*")
next
}else{
next
}
}
}
return(new.dat)
}
ppp <- starcalc(input.dat = bb)
input.dat <- bb
new.dat <- matrix(rep(NA, times = ncol(input.dat)*nrow(input.dat)))
new.dat <- matrix(rep(NA, times = ncol(input.dat)*nrow(input.dat)), ncol = ncol(input.dat), nrow = nrow(input.dat))
starcalc <- function(input.dat){
new.dat <- matrix(rep(NA, times = ncol(input.dat)*nrow(input.dat)), ncol = ncol(input.dat), nrow = nrow(input.dat))
for(i in 1:nrow(input.dat)){
for(j in 1:nrow(input.dat)){
if(is.na(input.dat[i,j])){
next
}else if(input.dat[i,j] < 0.0005){
new.dat[i,j] <- c("***")
next
}else if(input.dat[i,j] < 0.005){
new.dat[i,j] <- c("**")
next
}else if(input.dat[i,j] < 0.05){
new.dat[i,j] <- c("*")
next
}else{
next
}
}
}
return(new.dat)
}
ppp <- starcalc(input.dat = bb)
bb <- signif(kgt_vectsam1_pval, digits = 2)
jpeg("ERKi_correlation_matrix_medvect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.7, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_medvect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black")
dev.off()
View(kgt_vectsam1_pval)
colnames(kgt_vectsam1_pval)
cor.test(kgt_vectsam1$mTOR.S2448, kgt_vectsam1$X4EBP1.S65)
?cor.test
cor.test(kgt_vectsam1$mTOR.S2448, kgt_vectsam1$X4EBP1.S65, method = "spearman")
View(kgt_vectsam1_pval)
cor.test(kgt_vectsam1$mTOR.S2448, kgt_vectsam1$AMPKalpha.T172, method = "spearman")
cor.test(kgt_vectsam1$mTOR.S2448, kgt_vectsam1$AMPKalpha.T172, method = "spearman", alternative = "two.sided")
cor.test(kgt_vectsam1$mTOR.S2448, kgt_vectsam1$AMPKalpha.T172, method = "spearman", alternative = "less")
## Large size heatmap
kgt_vectsam2 <- kgt_replace[,vectsam2]
colnames(kgt_vectsam2) <- sub(pattern = "S6.Ribosomal.Protein.S240.244", replacement = "S6.Ribo.Protein.S240.244", x = colnames(kgt_vectsam2), fixed = TRUE)
colnames(kgt_vectsam1) <- sub(pattern = "S6.Ribosomal.Protein.S235.236", replacement = "S6.Ribo.Protein.S235.236", x = colnames(kgt_vectsam2), fixed = TRUE)
colnames(kgt_vectsam2) <- sub(pattern = "S6.Ribosomal.Protein.S235.236", replacement = "S6.Ribo.Protein.S235.236", x = colnames(kgt_vectsam2), fixed = TRUE)
z <- rcorr(as.matrix(kgt_vectsam2),type=c("spearman"))
kgt_vectsam2_spear <- z$r
kgt_vectsam2_pval <-z$P
bb <- signif(kgt_vectsam2_pval, digits = 2)
ppp <- starcalc(input.dat = bb)
jpeg("ERKi_correlation_matrix_largevect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 1, notecol = "black")
dev.off()
colnames(kgt_vectsam2)
colnames(kgt_vectsam2) <- sub(pattern = "Cytochrome.C.oxidoreductase", replacement = "Cytochr.C.oxidoreductase", x = colnames(kgt_vectsam2), fixed = TRUE)
colnames(kgt_vectsam2) <- sub(pattern = "BLVRB..Biliverdin.Reductase.B.", replacement = "BLVRB.Biliverdin.Red.B.", x = colnames(kgt_vectsam2), fixed = TRUE)
colnames(kgt_vectsam2) <- sub(pattern = "Acetyl.CoA.Carboxylase.S79", replacement = "Ac.CoA.Carboxylase.S79", x = colnames(kgt_vectsam2), fixed = TRUE)
colnames(kgt_vectsam2) <- sub(pattern = "Cu.Zn.Superoxide.Dismutase", replacement = "Cu.Zn.Superox.Dismutase", x = colnames(kgt_vectsam2), fixed = TRUE)
z <- rcorr(as.matrix(kgt_vectsam2),type=c("spearman"))
kgt_vectsam2_spear <- z$r
kgt_vectsam2_pval <-z$P
bb <- signif(kgt_vectsam2_pval, digits = 2)
ppp <- starcalc(input.dat = bb)
jpeg("ERKi_correlation_matrix_largevect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 1, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.7, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.4, notecol = "black")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.4, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho")
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho", key.ylab = NA)
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = "new",
margins = c(14,14), cellnote = bb, notecex = 0.4, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho", key.ylab = NA)
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = NA,
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho", key.ylab = NA)
dev.off()
jpeg("ERKi_correlation_matrix_largevect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam2_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = NA,
margins = c(14,14), cellnote = bb, notecex = 0.4, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho", key.ylab = NA)
dev.off()
z <- rcorr(as.matrix(kgt_vectsam1),type=c("spearman"))
kgt_vectsam1_spear <- z$r
kgt_vectsam1_pval <-z$P
bb <- signif(kgt_vectsam1_pval, digits = 2)
ppp <- starcalc(input.dat = bb)
jpeg("ERKi_correlation_matrix_medvect1_signifval.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = NA,
margins = c(14,14), cellnote = bb, notecex = 0.7, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho", key.ylab = NA)
dev.off()
jpeg("ERKi_correlation_matrix_medvect1_signifstar.jpg", height = 10, width = 10, units = "in", res = 1200)
#par(mai=c(1.02,0.82,0.82,0.42))
#par(mai=c(1.7,0.82,0.82,1.2))
heatmap.2(kgt_vectsam1_spear, trace = "none", col = colorpal, cexRow = 1.2, cexCol = 1.2, main = NA,
margins = c(14,14), cellnote = ppp, notecex = 1, notecol = "black",
key.title = NA, key.xlab = "Spearman's rho", key.ylab = NA)
dev.off()
setwd(dir = "C:/Users/Nate Diehl/Dropbox/HUGin/chromatinonlinedatabase/")
x <- read.table("Cells_EBV-transformed_lymphocytes.v7.egenes.txt", sep = "\t", header = TRUE)
View(x)
meqtl <- read.table("meQTL_raw.txt", sep = "\t", header = TRUE)
meqtl <- read.table("meQTL_raw.txt", sep = "\t", header = TRUE, row.names = NA)
?read.table
meqtl <- read.table("meQTL_raw.txt", sep = "\t", header = TRUE, row.names = NULL)
eqtl_raw <- read.table("Cells_EBV-transformed_lymphocytes.v7.egenes.txt", sep = "\t", header = TRUE)
